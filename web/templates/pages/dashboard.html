{{define "content"}}
<div class="mb-8">
    <h2 class="text-3xl font-bold text-white">Dashboard</h2>
    <p class="text-gray-400 mt-1">Overview of your task queue</p>
</div>

<!-- Stats Cards -->
<div id="stats-cards" hx-get="/dashboard/partials/stats" hx-trigger="every 3s" hx-swap="innerHTML">
    {{template "stats_cards.html" .}}
</div>

<!-- Charts -->
<div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mt-8">
    <div class="bg-dark-800 rounded-xl border border-gray-700/50 p-6">
        <h3 class="text-lg font-semibold text-white mb-4">Jobs Processed (Last 24h)</h3>
        <canvas id="processedChart" height="200"></canvas>
    </div>
    <div class="bg-dark-800 rounded-xl border border-gray-700/50 p-6">
        <h3 class="text-lg font-semibold text-white mb-4">Queue Sizes</h3>
        <canvas id="queueChart" height="200"></canvas>
    </div>
</div>

<!-- Recent Jobs -->
<div class="mt-8">
    <h3 class="text-lg font-semibold text-white mb-4">Recent Jobs</h3>
    <div class="bg-dark-800 rounded-xl border border-gray-700/50 overflow-hidden">
        <table class="w-full">
            <thead>
                <tr class="border-b border-gray-700/50">
                    <th class="text-left px-6 py-3 text-xs font-medium text-gray-400 uppercase">ID</th>
                    <th class="text-left px-6 py-3 text-xs font-medium text-gray-400 uppercase">Type</th>
                    <th class="text-left px-6 py-3 text-xs font-medium text-gray-400 uppercase">Priority</th>
                    <th class="text-left px-6 py-3 text-xs font-medium text-gray-400 uppercase">Status</th>
                    <th class="text-left px-6 py-3 text-xs font-medium text-gray-400 uppercase">Created</th>
                </tr>
            </thead>
            <tbody id="recent-jobs" hx-get="/dashboard/partials/jobs" hx-trigger="every 3s" hx-swap="innerHTML">
                {{range .recentJobs}}
                <tr class="border-b border-gray-700/30 hover:bg-dark-700/50 cursor-pointer" onclick="window.location='/dashboard/jobs/{{.ID}}'">
                    <td class="px-6 py-4 text-sm font-mono text-teal-400">{{truncate .ID 8}}</td>
                    <td class="px-6 py-4 text-sm">{{.Type}}</td>
                    <td class="px-6 py-4 text-sm">
                        <span class="px-2 py-1 text-xs rounded-full {{priorityBadge .Priority}}">{{.Priority.String}}</span>
                    </td>
                    <td class="px-6 py-4 text-sm">
                        <span class="px-2 py-1 text-xs rounded-full {{statusBadge (printf "%s" .Status)}}">{{upper (printf "%s" .Status)}}</span>
                    </td>
                    <td class="px-6 py-4 text-sm text-gray-400">{{formatTime .CreatedAt}}</td>
                </tr>
                {{else}}
                <tr>
                    <td colspan="5" class="px-6 py-8 text-center text-gray-500">No jobs yet</td>
                </tr>
                {{end}}
            </tbody>
        </table>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    initCharts({{.stats}});
});
</script>
{{end}}
